<%- include('partials/header') %>

<div class="container page-container">
    <% if (shared) { %>
        <div class="alert alert-success">
            <i class="fas fa-check-circle"></i>
            Text shared successfully! Share the link below.
        </div>
    <% } %>

    <h1 class="page-title">
        <i class="fas fa-<%= isPrivate ? 'lock' : 'file-alt' %>"></i>
        <%= isPrivate ? 'Private' : 'Shared' %> Text
    </h1>

    <div class="text-view-container">
        <div class="text-content">
            <pre><%= content.text %></pre>
        </div>

        <div class="text-info">
            <p><i class="fas fa-clock"></i> Shared: <span class="local-time" data-utc="<%= content.uploadTime %>"></span></p>
            <p><i class="fas fa-hourglass-half"></i> Expires: <span class="local-time" data-utc="<%= content.expiresAt %>"></span></p>
            <p><i class="fas fa-text-height"></i> Characters: <%= content.text.length %></p>
        </div>

        <% if (!isPrivate && shareUrl) { %>
            <div class="share-section">
                <h3>Share Link:</h3>
                <div class="share-box">
                    <input type="text" id="shareUrl" value="<%= shareUrl %>" readonly class="form-control">
                    <button class="btn btn-primary" onclick="copyShareUrl()">
                        <i class="fas fa-copy"></i>
                        Copy Link
                    </button>
                </div>
            </div>
        <% } %>

        <div class="action-buttons">
            <button class="btn btn-primary" onclick="copyText()">
                <i class="fas fa-copy"></i>
                Copy Text
            </button>
            <a href="/text" class="btn btn-secondary">
                <i class="fas fa-plus"></i>
                Share More Text
            </a>
            <a href="/" class="btn btn-outline">
                <i class="fas fa-home"></i>
                Home
            </a>
        </div>
    </div>
</div>

<script>
function copyShareUrl() {
    const urlInput = document.getElementById('shareUrl');
    urlInput.select();
    document.execCommand('copy');
    
    const btn = event.target.closest('button');
    const originalText = btn.innerHTML;
    btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
    setTimeout(() => {
        btn.innerHTML = originalText;
    }, 2000);
}

function copyText() {
    const textContent = document.querySelector('.text-content pre').textContent;
    navigator.clipboard.writeText(textContent).then(() => {
        const btn = event.target.closest('button');
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
        setTimeout(() => {
            btn.innerHTML = originalText;
        }, 2000);
    });
}
</script>

<%- include('partials/footer') %>